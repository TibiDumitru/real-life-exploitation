import winreg
from time import sleep
class bcolors:
    HEADER = '\033[95m'
    OKBLUE = '\033[94m'
    OKCYAN = '\033[96m'
    OKGREEN = '\033[92m'
    WARNING = '\033[93m'
    FAIL = '\033[91m'
    ENDC = '\033[0m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'


def check_registry_key(key_path, key_name, expected_value):
    try:
        key = winreg.OpenKey(winreg.HKEY_LOCAL_MACHINE, key_path, 0, winreg.KEY_READ)
        value, regtype = winreg.QueryValueEx(key, key_name)
        winreg.CloseKey(key)
        if str(value) == str(expected_value):
            return True
            # return "Key exists and value is: " + str(value)
        else:
            return False
            # return "Key exists and value is: " + str(value) + " but expected value is: " + str(expected_value)
    except WindowsError:
        return False
        # return "Key does not exist."



# Example usage: py .\check_registry.py
# Enter the registry key path: SYSTEM\CurrentControlSet\Control\Print\Providers\LanMan Print Services\Servers
# Enter the registry key name: AddPrinterDrivers
# Key exists and value is: 0

# py .\check_registry.py
# Enter the registry key path: Software\Policies\Microsoft\Windows NT\Printers\PointAndPrint
# Enter the registry key name: NoWarningNoElevationOnInstall
# Key does not exist.