import winreg

def check_registry_key(key_path, key_name):
    try:
        key = winreg.OpenKey(winreg.HKEY_LOCAL_MACHINE, key_path, 0, winreg.KEY_READ)
        value, regtype = winreg.QueryValueEx(key, key_name)
        winreg.CloseKey(key)
        return "Key exists and value is: " + str(value)
    except WindowsError:
        return "Key does not exist."


key_path = input("Enter the registry key path: ")
key_name = input("Enter the registry key name: ")
print(check_registry_key(key_path, key_name))

# Example usage: py .\check_registry.py
# Enter the registry key path: SYSTEM\CurrentControlSet\Control\Print\Providers\LanMan Print Services\Servers
# Enter the registry key name: AddPrinterDrivers
# Key exists and value is: 0

# py .\check_registry.py
# Enter the registry key path: Software\Policies\Microsoft\Windows NT\Printers\PointAndPrint
# Enter the registry key name: NoWarningNoElevationOnInstall
# Key does not exist.